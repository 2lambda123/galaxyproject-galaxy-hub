---
title: User Authentication via OpenID Connect Protocol 
highlight: true
---

Leveraging the OpenID Connect (OIDC) protocol users can login to Galaxy using their social and institutional 
identities (e.g., their Google account); as new users or associate multiple identities with an existing 
Galaxy user account.


**Related publications:**
- Jalili, Vahid, et al. ["Cloud Bursting Galaxy: Federated Identity and Access Management."](https://www.biorxiv.org/content/10.1101/506238v1) bioRxiv (2018): 506238.


# Enable OIDC-based Login 

The OIDC-based login is disabled by default, and to enable it take the following steps:

1. In your Galaxy instance directory, goto the `/config` folder and create a copy of `galaxy.yml.sample` and name it
`galaxy.yml`; if you have not done that yet.
 
2. Open the `/config/galaxy.yml` file, and uncomment `enable_oidc`, `oidc_config_file`, and `oidc_backends_config_file` 
attributes and set them as the following:

    ```yaml
    # Enables and disables OpenID Connect (OIDC) support.
    enable_oidc: true
    
    # Sets the path to OIDC configuration file.
    oidc_config_file: config/oidc_config.xml
    
    # Sets the path to OIDC backends configuration file.
    oidc_backends_config_file: config/oidc_backends_config.xml
    ```

3. Create the `config/oidc_config.xml` and `config/oidc_backends_config.xml` using their sample. See the following 
section on how to set each of these files.


# Configure OIDC Backends

The OIDC identity providers (IdPs) are configured in the `config/oidc_config.xml`, via a `provider` block per IdP.
There could be multiple providers defined in this file, and each provider is configured with settings specific 
to that IdP. For instance, using the following configuration we define Google and Globus backends: 

```xml
<?xml version="1.0"?>
<OIDC>
    <provider name="Google">
        <client_id> ... </client_id>
        <client_secret> ... </client_secret>
        <redirect_uri>http://localhost:8080/authnz/google/callback</redirect_uri>
        <prompt>consent</prompt>
    </provider>
    <provider name="Globus">
        <client_id> ... </client_id>
        <client_secret> ... </client_secret>
        <redirect_uri>http://localhost:8080/authnz/globus/callback</redirect_uri>
        <prompt>consent</prompt>
    </provider>
</OIDC>
```

Currently Galaxy supports the following IdPs: 

- Google (read [how to configure this provider](/src/authnz/config/oidc/idps/google/index.md));

- Globus (read [how to configure this provider](/src/authnz/config/oidc/idps/google/index.md));

Since all providers are OIDC-based IdPs, they have mostly common configuration keys 
(e.g., `client_id` and `client_secret`). In the following we explain the most common 
configuration keys, and you may visit aforementioned provider configuration pages for 
their specific configuration keys. 

## Client ID

The **Client ID** attribute is a string that identifies your Galaxy instance to the IdP, and it is unique to the IdP: 

> a unique string representing the registration information provided by the client. 
The client identifier is not a secret; it is exposed to the resource owner and MUST NOT be used 
alone for client authentication. The client identifier is unique to the authorization server.
[[Ref](https://tools.ietf.org/html/rfc6749#section-2.2)]

You obtain this ID when registering your Galaxy instance with the IdP (see the aforementioned links on how to 
register your Galaxy instance (aka client) with the each provider). Having obtained the **Client ID** attribute,
you may set it using the following setter: 

```xml
<client_id> ... </client_id>
```

## Client Secret

The **Client Secret** attribute is a string generated by IdP for your client upon its registration
with the IdP. You may use the following setter for client secret: 

```xml
<client_secret> ... </client_secret>
```

## Redirect URI

The **Redirect URI** is the absolute endpoint that you provide it to the IdP when registering your 
Galaxy instance, and the IdP will your Galaxy instance at that URI upon successful user authentication: 


> After completing its interaction with the resource owner, the authorization server 
directs the resource owner's user-agent back to the client.  The authorization server 
redirects the user-agent to the client's redirection endpoint previously established 
with the authorization server during the client registration process or when making 
the authorization request. The redirection endpoint URI MUST be an absolute URI ...
[[Ref](https://tools.ietf.org/html/rfc6749#section-3.1.2)]

This URL for your Galaxy instance is composed as:

```
<Host URI>/authnz/<provider>/callback
```

For instance:

- using localhost to authenticate with Google:

    ```
    http://localhost:8080/authnz/google/callback
    ```

- using localhost to authenticate with Globus:

    ```
    http://localhost:8080/authnz/globus/callback
    ```

 - using an instance hosted at `https://usegalaxy.org` with Google:
 
    ```
    https://usegalaxy.org/authnz/google/callback
    ```
    
Please mind `http` and `https`.
 
Having defined your instance URI for an IdP following the aforementioned template, 
set it as the following Galaxy, and use the same URI for your client registration.
 
```xml
<redirect_uri> ... </redirect_uri>
```

For instance:

```xml
<redirect_uri>http://localhost:8080/authnz/google/callback</redirect_uri>
```

# Global OIDC Configuration


