---
title: "Generic scatter plots for any Galaxy tabular data"
date: "2023-08-07"
authors: Ross Lazarus
authors_structured:
- github: fubar2
tease: "A tool generating interactive HTML scatter plots from Galaxy tabular data is now available for testing"
hide_tease: true
subsites: [all]
---

### Sample use case - Iris data scatterplot with mouse-over hover showing species in Galaxy

Galaxy users can now easily turn this:

![iris data](./iris_data_in_galaxy.png)

into this interactive HTML output:

<iframe src="https://lazarus.name/demo/Plotlytabular_Iris_data_on_iris_html.html" width="1024" height="768" resize="both" overflow="auto"  style="border:none;">
</iframe>

(hover the browser pointer over any point to see details including the Species column)

by setting up a Galaxy tool form like this:

![Plotlytabular tool form for Iris data](./iris_plotlytab_form.png)

The tool form has selected the *Iris data* as the input tabular data from the history.
*Any existing Galaxy tabular data can be used*. The iris data already has column names in the data, such as 'species',
so they are used for the required x, y, and the optional colour and optional hover columns for the plot.

The optional hover column allows detailed information about points of interest
such as outliers or isolated groups, to be displayed when the viewer hovers the mouse pointer
over any point. In this example, the species is provided, but any column can be chosen.

### Input data headers and dimensionality

This Iris test data is relatively tiny with about 150 rows, so the points
are nicely separated, making the hover information easy to use.

Interactive html plots work best for at most, a few thousand well spread points,
so the hover display is easy to control.

Interactive html output is available in stand alone format, where 3MB of javascript is included,
allowing it to be viewed offline. Short form html requires an internet connection to download the
javascript into the browser so cannot be viewed offline.

PNG plots are recommended for large numbers of rows, since the the hover function tends to be less useful
when the plot is very crowded.

If the tabular data does not have a header row of column names, the user can supply and use a
comma delimited list, as the "header" parameter on the tool form.
If these are both missing, use col1....colN which are the default, autogenerated names</br>
Any named column can be used as the x, y, colour or hover columns.

#### Warning

Plotly.express will usually make sensible choices about how to show whatever you throw at it - with the current
notable exception of columns of very small floats in scientific notation. It thinks they must be strings,
or something, so Bad Things Happen unless a transformation, such as -log10(x) is used, as is done for
columns of very tiny evalues, in the specialised Blast version below. Rescaling gives sensible plots and
transformed evalues seem highly collinear with bitscores, in the few samples tested.

### Installation for testing

The [plotly_tabular_plot](https://toolshed.g2.bx.psu.edu/repository/browse_repository?id=a4961ff57ce13935) tool, owned by fubar, is available for testing, in the main Galaxy Toolshed.
It is very new and so not suitable for production use yet. Please let me know if it works for you.

### Tool code

The tool code is available for review at the <a href="https://github.com/fubar2/plotly_tabular_tool">github repository</a> where issues should
be raised when there are problems or suggestions. This is machine generated code, so pull requests don't
make much sense. The generator can be rerun with simple changes easily so please suggest
any useful things you'd like to see.

### Regenerating and editing the tool

This tool was created using the <a href="https://github.com/fubar2/galaxy_tf_overlay">ToolFactory</a> automated, form driven code generator
described in this <a href="https://training.galaxy.lazarus.name/training-material/topics/dev/tutorials/tool-generators/tutorial.html">training module.</a>

This generic tabular file plotter tool is now included in the ToolFactory docker or local installation, in a built-in history containing 3
advanced examples.

The code and test for the tool in the Toolshed can be regenerated by re-running the supplied history job in the ToolFactory.

The regenerated tool form can be edited, changing the tool_id to create a new tool. The new tool could be specialised for
certain kinds of tabular data, such as this [25 column Galaxy Blast search output plotter](https://github.com/fubar2/plotly_blast_tool). It
was generated using the generic tabular plotter as the starting point, adding a default header and
a transformation of the evalues, to make it better suited to that specific kind of data. That generated tool is also included in the
ToolFactory built-in advanced history.



